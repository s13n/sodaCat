name: SAES
description: Secure AES coprocessor
groupName: SAES
registers:
  - name: CR
    displayName: CR
    description: SAES control register
    addressOffset: 0
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: EN
        description: Enable
        bitOffset: 0
        bitWidth: 1
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Disable
            value: 0
          - name: B_0x1
            description: Enable
            value: 1
      - name: DATATYPE
        description: Data type
        bitOffset: 1
        bitWidth: 2
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: No swapping (32-bit data).
            value: 0
          - name: B_0x1
            description: Half-word swapping (16-bit data)
            value: 1
          - name: B_0x2
            description: Byte swapping (8-bit data)
            value: 2
          - name: B_0x3
            description: Bit-level swapping
            value: 3
      - name: MODE
        description: Operating mode
        bitOffset: 3
        bitWidth: 2
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Encryption
            value: 0
          - name: B_0x1
            description: Key derivation (or key preparation), for ECB/CBC decryption only
            value: 1
          - name: B_0x2
            description: Decryption
            value: 2
      - name: CHMOD
        description: 'CHMOD[1:0]: Chaining mode'
        bitOffset: 5
        bitWidth: 2
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Electronic codebook (ECB)
            value: 0
          - name: B_0x1
            description: Cipher-block chaining (CBC)
            value: 1
          - name: B_0x2
            description: Counter mode (CTR)
            value: 2
          - name: B_0x3
            description: Galois counter mode (GCM) and Galois message authentication code (GMAC)
            value: 3
      - name: DMAINEN
        description: DMA input enable
        bitOffset: 11
        bitWidth: 1
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Disable
            value: 0
          - name: B_0x1
            description: Enable
            value: 1
      - name: DMAOUTEN
        description: DMA output enable
        bitOffset: 12
        bitWidth: 1
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Disable
            value: 0
          - name: B_0x1
            description: Enable
            value: 1
      - name: GCMPH
        description: GCM or CCM phase selection
        bitOffset: 13
        bitWidth: 2
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Initialization phase
            value: 0
          - name: B_0x1
            description: Header phase
            value: 1
          - name: B_0x2
            description: Payload phase
            value: 2
          - name: B_0x3
            description: Final phase
            value: 3
      - name: CHMOD_1
        description: CHMOD[2]
        bitOffset: 16
        bitWidth: 1
        access: read-write
      - name: KEYSIZE
        description: Key size selection
        bitOffset: 18
        bitWidth: 1
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: 128-bit
            value: 0
          - name: B_0x1
            description: 256-bit
            value: 1
      - name: KEYPROT
        description: Key protection
        bitOffset: 19
        bitWidth: 1
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: When KEYVALID is set and KEYSEL[2:0] = 0 application can transfer the ownership of the SAES, with its loaded key, to an application running in another security context (such as non-secure, secure).
            value: 0
          - name: B_0x1
            description: When KEYVALID is set, key error flag (KEIF) is set when an access to any registers is detected, this access having a security context (for example, secure, non-secure) that does not match the one of the application that loaded the key.
            value: 1
      - name: NPBLB
        description: Number of padding bytes in last block
        bitOffset: 20
        bitWidth: 4
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: All bytes are valid (no padding)
            value: 0
          - name: B_0x1
            description: Padding for the last LSB byte
            value: 1
          - name: B_0xF
            description: Padding for the 15 LSB bytes of last block.
            value: 15
      - name: KMOD
        description: Key mode selection
        bitOffset: 24
        bitWidth: 2
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Normal key mode. Key registers are freely usable and no specific use or protection applies to SAES_DINR and SAES_DOUTR registers.
            value: 0
          - name: B_0x1
            description: Wrapped key mode. Key loaded in key registers can only be used to encrypt or decrypt AES keys. Hence, when a decryption is selected, read-as-zero SAES_DOUTR register is automatically loaded into SAES key registers after a successful decryption process.
            value: 1
          - name: B_0x2
            description: Shared key mode. After a successful decryption process, SAES key registers are shared with the peripheral described in KSHAREID[1:0] bitfield. This sharing is valid only while KMOD[1:0] at 0x2 and KEYVALID=1. When a decryption is selected, read-as-zero SAES_DOUTR register is automatically loaded into SAES key registers after a successful decryption process.
            value: 2
      - name: KSHAREID
        description: Key share identification
        bitOffset: 26
        bitWidth: 2
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: CRYP peripheral
            value: 0
      - name: KEYSEL
        description: Key selection
        bitOffset: 28
        bitWidth: 3
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Software key, loaded in key registers SAES_KEYx
            value: 0
          - name: B_0x1
            description: Derived hardware unique key (DHUK)
            value: 1
          - name: B_0x2
            description: Boot hardware key (BHK)
            value: 2
          - name: B_0x4
            description: XOR of DHUK and BHK
            value: 4
          - name: B_0x7
            description: Test mode key (256-bit hardware constant 0xA5A5...A5A5)
            value: 7
      - name: IPRST
        description: SAES peripheral software reset
        bitOffset: 31
        bitWidth: 1
        access: read-write
  - name: SR
    displayName: SR
    description: SAES status register
    addressOffset: 4
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: RDERRF
        description: Read error flag
        bitOffset: 1
        bitWidth: 1
        access: read-only
        enumeratedValues:
          - name: B_0x0
            description: No error
            value: 0
          - name: B_0x1
            description: Unexpected read to SAES_DOUTR register occurred during computation or data input phase.
            value: 1
      - name: WRERRF
        description: Write error flag
        bitOffset: 2
        bitWidth: 1
        access: read-only
        enumeratedValues:
          - name: B_0x0
            description: No error
            value: 0
          - name: B_0x1
            description: Unexpected write to SAES_DINR register occurred during computation or data output phase.
            value: 1
      - name: BUSY
        description: Busy
        bitOffset: 3
        bitWidth: 1
        access: read-only
        enumeratedValues:
          - name: B_0x0
            description: Idle
            value: 0
          - name: B_0x1
            description: Busy
            value: 1
      - name: KEYVALID
        description: Key valid flag
        bitOffset: 7
        bitWidth: 1
        access: read-only
        enumeratedValues:
          - name: B_0x0
            description: Key not valid
            value: 0
          - name: B_0x1
            description: Key valid
            value: 1
  - name: DINR
    displayName: DINR
    description: SAES data input register
    addressOffset: 8
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: DIN
        description: Data input
        bitOffset: 0
        bitWidth: 32
        access: write-only
  - name: DOUTR
    displayName: DOUTR
    description: SAES data output register
    addressOffset: 12
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: DOUT
        description: Data output
        bitOffset: 0
        bitWidth: 32
        access: read-only
  - name: KEYR0
    displayName: KEYR0
    description: SAES key register 0
    addressOffset: 16
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: KEY
        description: Cryptographic key, bits [31:0]
        bitOffset: 0
        bitWidth: 32
        access: write-only
  - name: KEYR1
    displayName: KEYR1
    description: SAES key register 1
    addressOffset: 20
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: KEY
        description: Cryptographic key, bits [63:32]
        bitOffset: 0
        bitWidth: 32
        access: write-only
  - name: KEYR2
    displayName: KEYR2
    description: SAES key register 2
    addressOffset: 24
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: KEY
        description: Cryptographic key, bits [95:64]
        bitOffset: 0
        bitWidth: 32
        access: write-only
  - name: KEYR3
    displayName: KEYR3
    description: SAES key register 3
    addressOffset: 28
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: KEY
        description: Cryptographic key, bits [127:96]
        bitOffset: 0
        bitWidth: 32
        access: write-only
  - name: IVR0
    displayName: IVR0
    description: SAES initialization vector register 0
    addressOffset: 32
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: IVI
        description: Initialization vector input, bits [31:0]
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: IVR1
    displayName: IVR1
    description: SAES initialization vector register 1
    addressOffset: 36
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: IVI
        description: Initialization vector input, bits [63:32]
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: IVR2
    displayName: IVR2
    description: SAES initialization vector register 2
    addressOffset: 40
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: IVI
        description: Initialization vector input, bits [95:64]
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: IVR3
    displayName: IVR3
    description: SAES initialization vector register 3
    addressOffset: 44
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: IVI
        description: Initialization vector input, bits [127:96]
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: KEYR4
    displayName: KEYR4
    description: SAES key register 4
    addressOffset: 48
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: KEY
        description: Cryptographic key, bits [159:128]
        bitOffset: 0
        bitWidth: 32
        access: write-only
  - name: KEYR5
    displayName: KEYR5
    description: SAES key register 5
    addressOffset: 52
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: KEY
        description: Cryptographic key, bits [191:160]
        bitOffset: 0
        bitWidth: 32
        access: write-only
  - name: KEYR6
    displayName: KEYR6
    description: SAES key register 6
    addressOffset: 56
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: KEY
        description: Cryptographic key, bits [223:192]
        bitOffset: 0
        bitWidth: 32
        access: write-only
  - name: KEYR7
    displayName: KEYR7
    description: SAES key register 7
    addressOffset: 60
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: KEY
        description: Cryptographic key, bits [255:224]
        bitOffset: 0
        bitWidth: 32
        access: write-only
  - name: SUSPR0
    displayName: SUSPR0
    description: SAES suspend registers
    addressOffset: 64
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: SUSP
        description: Suspend data
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: SUSPR1
    displayName: SUSPR1
    description: SAES suspend registers
    addressOffset: 68
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: SUSP
        description: Suspend data
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: SUSPR2
    displayName: SUSPR2
    description: SAES suspend registers
    addressOffset: 72
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: SUSP
        description: Suspend data
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: SUSPR3
    displayName: SUSPR3
    description: SAES suspend registers
    addressOffset: 76
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: SUSP
        description: Suspend data
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: SUSPR4
    displayName: SUSPR4
    description: SAES suspend registers
    addressOffset: 80
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: SUSP
        description: Suspend data
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: SUSPR5
    displayName: SUSPR5
    description: SAES suspend registers
    addressOffset: 84
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: SUSP
        description: Suspend data
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: SUSPR6
    displayName: SUSPR6
    description: SAES suspend registers
    addressOffset: 88
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: SUSP
        description: Suspend data
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: SUSPR7
    displayName: SUSPR7
    description: SAES suspend registers
    addressOffset: 92
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: SUSP
        description: Suspend data
        bitOffset: 0
        bitWidth: 32
        access: read-write
  - name: IER
    displayName: IER
    description: SAES interrupt enable register
    addressOffset: 768
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: CCFIE
        description: Computation complete flag interrupt enable
        bitOffset: 0
        bitWidth: 1
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Disabled (masked)
            value: 0
          - name: B_0x1
            description: Enabled (not masked)
            value: 1
      - name: RWEIE
        description: Read or write error interrupt enable
        bitOffset: 1
        bitWidth: 1
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Disabled (masked)
            value: 0
          - name: B_0x1
            description: Enabled (not masked)
            value: 1
      - name: KEIE
        description: Key error interrupt enable
        bitOffset: 2
        bitWidth: 1
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Disabled (masked)
            value: 0
          - name: B_0x1
            description: Enabled (not masked)
            value: 1
      - name: RNGEIE
        description: RNG error interrupt enable
        bitOffset: 3
        bitWidth: 1
        access: read-write
        enumeratedValues:
          - name: B_0x0
            description: Disabled (masked)
            value: 0
          - name: B_0x1
            description: Enabled (not masked)
            value: 1
  - name: ISR
    displayName: ISR
    description: SAES interrupt status register
    addressOffset: 772
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: CCF
        description: Computation complete flag
        bitOffset: 0
        bitWidth: 1
        access: read-only
        enumeratedValues:
          - name: B_0x0
            description: Not completed
            value: 0
          - name: B_0x1
            description: Completed
            value: 1
      - name: RWEIF
        description: Read or write error interrupt flag
        bitOffset: 1
        bitWidth: 1
        access: read-only
        enumeratedValues:
          - name: B_0x0
            description: No read or write error detected
            value: 0
          - name: B_0x1
            description: Read or write error detected
            value: 1
      - name: KEIF
        description: Key error interrupt flag
        bitOffset: 2
        bitWidth: 1
        access: read-only
        enumeratedValues:
          - name: B_0x0
            description: No key error detected
            value: 0
          - name: B_0x1
            description: Key information failed to load into key registers or the key register use is forbidden
            value: 1
      - name: RNGEIF
        description: RNG error interrupt flag
        bitOffset: 3
        bitWidth: 1
        access: read-only
        enumeratedValues:
          - name: B_0x0
            description: RNG bus is functional
            value: 0
          - name: B_0x1
            description: Error detected on RNG bus interface (random seed fetching error)
            value: 1
  - name: ICR
    displayName: ICR
    description: SAES interrupt clear register
    addressOffset: 776
    size: 32
    resetValue: 0
    resetMask: 4294967295
    fields:
      - name: CCF
        description: Computation complete flag clear
        bitOffset: 0
        bitWidth: 1
        access: write-only
      - name: RWEIF
        description: Read or write error interrupt flag clear
        bitOffset: 1
        bitWidth: 1
        access: write-only
      - name: KEIF
        description: Key error interrupt flag clear
        bitOffset: 2
        bitWidth: 1
        access: write-only
      - name: RNGEIF
        description: RNG error interrupt flag clear
        bitOffset: 3
        bitWidth: 1
        access: write-only
addressBlocks:
  - offset: 0
    size: 1024
    usage: registers
interrupts:
  - name: INTR
    description: SAES global interrupt
