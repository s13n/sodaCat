family: LPC865
description: Complete clock tree based on UM11607 Figures 7 & 8
signals:
  - { name: fro_oscout, min: 36000000, max: 60000000, description: "The output of the FRO oscillator" }
  - { name: fro_div2 }
  - { name: fro }
  - { name: fro_div }
  - { name: fro_div_wkt, nominal: 750000 }
  - { name: clkin, max: 60000000, description: "Internal clock that comes from the main CLKIN pin function." }
  - { name: sys_osc_clk, max: 25000000, description: "Internal clock that comes from external crystal oscillator" }
  - { name: external_clk, description: "Internal clock that comes from the crystal oscillator or the CLK_IN pin" }
  - { name: lp_osc, nominal: 1000000 }
  - { name: pll_in, min: 10000000, max: 25000000 }
  - { name: sys_pll0_clk, max: 100000000 }
  - { name: pll_div_clk }
  - { name: main_clk_pre_pll }
  - { name: main_clk, description: "The main clock used to generate the system clock and other clocks" }
  - { name: system_clk, max: 60000000, description: "The clock used for the CPU and the buses" }
  - { name: adc_clk }
  - { name: adc_div_clk }
  - { name: clkout_src }
  - { name: clkout }
  - { name: frg0clksel }
  - { name: frg0clk }
  - { name: frg1clksel }
  - { name: frg1clk }
  - { name: lpwr_clk_vulp, nominal: 10000, min: 6000, max: 14000 }
  - { name: acmpclk }
  - { name: adc_sclk }
  - { name: crcclk }
  - { name: dmaclk }
  - { name: fclk0, description: "Functional clock for UART0" }
  - { name: fclk1, description: "Functional clock for UART1" }
  - { name: fclk10, description: "Functional clock for SPI1" }
  - { name: fclk2, description: "Functional clock for UART2" }
  - { name: fclk5, description: "Functional clock for I2C0" }
  - { name: fclk9, description: "Functional clock for SPI0" }
  - { name: flashclk }
  - { name: ftm0clk }
  - { name: ftm1clk }
  - { name: gpio0clk }
  - { name: gpio1clk }
  - { name: gpiointclk }
  - { name: i2c0clk }
  - { name: ioconclk, description: "Register clock for IOCON" }
  - { name: mrtclk }
  - { name: ramclk }
  - { name: romclk }
  - { name: spi0clk }
  - { name: spi1clk }
  - { name: swmclk }
  - { name: uart0clk }
  - { name: uart1clk }
  - { name: uart2clk }
  - { name: i3cclk, description: "Register clock for I3C" }
  - { name: i3cfclk }
  - { name: i3cslowtcclk }
  - { name: i3cslowclk }
  - { name: wkt_counter_clk }
  - { name: wkt_int_clk }
  - { name: wktclk }
  - { name: wktclkin }
  - { name: wwdtclk }
  - { name: ioconclkdiv0 }
  - { name: ioconclkdiv1 }
  - { name: ioconclkdiv2 }
  - { name: ioconclkdiv3 }
  - { name: ioconclkdiv4 }
  - { name: ioconclkdiv5 }
  - { name: ioconclkdiv6 }

sources:
  - name: FRO
    output: fro_oscout
    frequencies: [0, 36000000, 48000000, 60000000]
  - name: CLKIN
    output: clkin
    description: Special function of PIO0_1
  - name: XTALIN
    output: sys_osc_clk
    reg: SYSOSCCTRL
    field: BYPASS
  - name: WKTCLKIN
    output: wktclkin
    description: Special function of PIO0_28
  - name: LPOSC
    output: lp_osc
    reg: LPOSCCTRL
    field: FREQSEL
  - name: ULPOSC
    output: lpwr_clk_vulp
    reg: DPDCTRL
    field: ULPOSCEN

muxes:
  - name: EXTCLKSEL
    output: external_clk
    inputs: [sys_osc_clk, clkin]
    reg: EXTCLKSEL
    field: SEL
  - name: FROOSCCTRL
    output: fro
    inputs: [fro_oscout, fro_div2]
    reg: FROOSCCTRL
    field: FRO_DIRECT
  - name: SYSPLLCLKSEL
    output: pll_in
    inputs: [fro, external_clk, lp_osc, fro_div]
    reg: SYSPLLCLKSEL
    field: SEL
  - name: MAINCLKSEL
    output: main_clk_pre_pll
    inputs: [fro, external_clk, lp_osc, fro_div]
    reg: MAINCLKSEL
    field: SEL
  - name: MAINCLKPLLSEL
    output: main_clk
    inputs: [main_clk_pre_pll, sys_pll0_clk, "", ""]
    reg: MAINCLKPLLSEL
    field: SEL
  - name: CLKOUTSEL
    output: clkout_src
    inputs: [fro, main_clk, pll_div_clk, external_clk, lp_osc, "", "", ""]
    reg: CLKOUTSEL
    field: SEL
  - name: ADCCLKSEL
    output: adc_clk
    inputs: [fro, pll_div_clk, "", ""]
    reg: ADCCLKSEL
    field: SEL
  - name: FRG0CLKSEL
    output: frg0clksel
    inputs: [fro, main_clk, pll_div_clk, ""]
    reg: FRG0CLKSEL
    field: SEL
  - name: FRG1CLKSEL
    output: frg1clksel
    inputs: [fro, main_clk, pll_div_clk, ""]
    reg: FRG1CLKSEL
    field: SEL
  - name: UART0CLKSEL
    output: uart0clk
    inputs: [fro, main_clk, frg0clk, frg1clk, fro_div, "", "", ""]
    reg: UART0CLKSEL
    field: SEL
  - name: UART1CLKSEL
    output: uart1clk
    inputs: [fro, main_clk, frg0clk, frg1clk, fro_div, "", "", ""]
    reg: UART1CLKSEL
    field: SEL
  - name: UART2CLKSEL
    output: uart2clk
    inputs: [fro, main_clk, frg0clk, frg1clk, fro_div, "", "", ""]
    reg: UART2CLKSEL
    field: SEL
  - name: SPI0CLKSEL
    output: spi0clk
    inputs: [fro, main_clk, frg0clk, frg1clk, fro_div, "", "", ""]
    reg: SPI0CLKSEL
    field: SEL
  - name: SPI1CLKSEL
    output: spi1clk
    inputs: [fro, main_clk, frg0clk, frg1clk, fro_div, "", "", ""]
    reg: SPI1CLKSEL
    field: SEL
  - name: I2C0CLKSEL
    output: i2c0clk
    inputs: [fro, main_clk, frg0clk, frg1clk, fro_div, "", "", ""]
    reg: I2C0CLKSEL
    field: SEL
  - name: I3CFCLKSEL
    output: i3cfclk
    inputs: [fro, main_clk, frg0clk, frg1clk, fro_div, null, null, ""]
    reg: I3CFCLKSEL
    field: SEL
  - name: I3CSLOWTCCLKSEL
    output: i3cslowtcclk
    inputs: [fro, main_clk, frg0clk, frg1clk, fro_div, null, null, ""]
    reg: I3CSLOWTCCLKSEL
    field: SEL
  - name: I3CSLOWCLKSEL
    output: i3cslowclk
    inputs: [fro, main_clk, frg0clk, frg1clk, fro_div, null, null, ""]
    reg: I3CSLOWCLKSEL
    field: SEL
  - name: wkt_mux_int
    field: CLKSEL
    reg: WKT_CTRL
    inputs: [fro_div_wkt, lpwr_clk_vulp]
    output: wkt_int_clk
  - name: wkt_mux_ext
    field: SEL_EXTCLK
    reg: WKT_CTRL
    inputs: [wkt_int_clk, wktclkin]
    output: wkt_counter_clk

plls:
  - name: SYSPLL
    input: pll_in
    output: sys_pll0_clk
    regs:
      - { reg: SYSPLLCTRL, field: MSEL }
      - { reg: SYSPLLCTRL, field: PSEL }
      - { reg: SYSPLLSTAT, field: LOCK }

dividers:
  - name: FRO_HALF_DIV
    input: fro_oscout
    output: fro_div2
    divisor: 2
  - name: FRO_DIV
    input: fro
    output: fro_div
    divisor: 2
  - name: FRO_DIV_WKT
    input: fro
    output: fro_div_wkt
    divisor: 16
    description: Divider in the WKT block
  - name: SYSPLLDIV
    input: sys_pll0_clk
    output: pll_div_clk
    reg: SYSPLLDIV
    field: DIV
  - name: SYSAHBCLKDIV
    input: main_clk
    output: system_clk
    reg: SYSAHBCLKDIV
    field: DIV
  - name: IOCONCLKDIV0
    input: main_clk
    output: ioconclkdiv0
    reg: IOCONFILTCLKDIV0
    field: DIV
  - name: IOCONCLKDIV1
    input: main_clk
    output: ioconclkdiv1
    reg: IOCONFILTCLKDIV1
    field: DIV
  - name: IOCONCLKDIV2
    input: main_clk
    output: ioconclkdiv2
    reg: IOCONFILTCLKDIV2
    field: DIV
  - name: IOCONCLKDIV3
    input: main_clk
    output: ioconclkdiv3
    reg: IOCONFILTCLKDIV3
    field: DIV
  - name: IOCONCLKDIV4
    input: main_clk
    output: ioconclkdiv4
    reg: IOCONFILTCLKDIV4
    field: DIV
  - name: IOCONCLKDIV5
    input: main_clk
    output: ioconclkdiv5
    reg: IOCONFILTCLKDIV5
    field: DIV
  - name: IOCONCLKDIV6
    input: main_clk
    output: ioconclkdiv6
    reg: IOCONFILTCLKDIV6
    field: DIV
  - name: ADCCLKDIV
    input: adc_clk
    output: adc_div_clk
    reg: ADCCLKDIV
    field: DIV
  - name: I3CFCLKDIV
    input: i3cfclk
    output: i3c_fclk
    reg: I3CCLKDIV
    field: I3C_FCLK_DIV
  - name: I3CSLOWTCCLKDIV
    input: i3cslowtcclk
    output: i3c_clk_slow_tc
    reg: I3CCLKDIV
    field: I3C_SLOW_TC_CLK_DIV
  - name: I3CSLOWCLKDIV
    input: i3cslowclk
    output: i3c_clk_slow
    reg: I3CCLKDIV
    field: I3C_SLOW_CLK_DIV
  - name: CLKOUTDIV
    input: clkout_src
    output: clkout
    reg: CLKOUTDIV
    field: DIV
  - name: FRG0
    input: frg0clksel
    output: frg0clk
    regs:
      - { reg: FRG0DIV, field: DIV }
      - { reg: FRG0MULT, field: MULT }
  - name: FRG1
    input: frg1clksel
    output: frg1clk
    regs:
      - { reg: FRG1DIV, field: DIV }
      - { reg: FRG1MULT, field: MULT }

gates:
  - name: ROMCLK
    output: romclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: ROM
  - name: RAMCLK
    output: ramclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: RAM
  - name: FLASHCLK
    output: flashclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: FLASH
  - name: I2C0CLK
    output: fclk5
    input: i2c0clk
    reg: SYSAHBCLKCTRL0
    field: I2C0
  - name: GPIO0CLK
    output: gpio0clk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: GPIO0
  - name: SWMCLK
    output: swmclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: SWM
  - name: WKTCLK
    output: wktclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: WKT
  - name: MRTCLK
    output: mrtclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: MRT
  - name: SPI0CLK
    output: fclk9
    input: spi0clk
    reg: SYSAHBCLKCTRL0
    field: SPI0
  - name: SPI1CLK
    output: fclk10
    input: spi1clk
    reg: SYSAHBCLKCTRL0
    field: SPI1
  - name: CRCCLK
    output: crcclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: CRC
  - name: UART0CLK
    output: fclk0
    input: uart0clk
    reg: SYSAHBCLKCTRL0
    field: UART0
  - name: UART1CLK
    output: fclk1
    input: uart1clk
    reg: SYSAHBCLKCTRL0
    field: UART1
  - name: UART2CLK
    output: fclk2
    input: uart2clk
    reg: SYSAHBCLKCTRL0
    field: UART2
  - name: WWDTCLK
    output: wwdtclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: WWDT
  - name: IOCONCLK
    output: ioconclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: IOCON
  - name: ACMPCLK
    output: acmpclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: ACMP
  - name: GPIO1CLK
    output: gpio1clk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: GPIO1
  - name: FTM0CLK
    output: ftm0clk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: FTM0
  - name: FTM1CLK
    output: ftm1clk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: FTM1
  - name: I3CCLK
    output: i3cclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: I3C
  - name: ADC
    output: adc_sclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: ADC
  - name: GPIOINTCLK
    output: gpiointclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: GPIO_INT
  - name: DMACLK
    output: dmaclk
    input: system_clk
    reg: SYSAHBCLKCTRL0
    field: DMA
