name: Flash
description: FLASH
groupName: FLASH
source: STM32F767 SVD v1.6
params:
  has_pcrop:
    type: bool
    default: false
    description: PCROP protection support (RDERR, RDERRIE, OPTCR2)
  has_dual_bank:
    type: bool
    default: false
    description: Dual-bank Flash support (MER2, nDBOOT, nDBANK)
registers:
  - name: ACR
    displayName: ACR
    description: Flash access control register
    addressOffset: 0
    size: 32
    access: read-write
    resetValue: 0
    fields:
      - name: LATENCY
        description: Latency
        bitOffset: 0
        bitWidth: 4
      - name: PRFTEN
        description: Prefetch enable
        bitOffset: 8
        bitWidth: 1
      - name: ARTEN
        description: ART Accelerator Enable
        bitOffset: 9
        bitWidth: 1
      - name: ARTRST
        description: ART Accelerator reset
        bitOffset: 11
        bitWidth: 1
  - name: KEYR
    displayName: KEYR
    description: Flash key register
    addressOffset: 4
    size: 32
    access: write-only
    resetValue: 0
    fields:
      - name: KEY
        description: FPEC key
        bitOffset: 0
        bitWidth: 32
  - name: OPTKEYR
    displayName: OPTKEYR
    description: Flash option key register
    addressOffset: 8
    size: 32
    access: write-only
    resetValue: 0
    fields:
      - name: OPTKEYR
        description: Option byte key
        bitOffset: 0
        bitWidth: 32
  - name: SR
    displayName: SR
    description: Status register
    addressOffset: 12
    size: 32
    resetValue: 0
    fields:
      - name: EOP
        description: End of operation
        bitOffset: 0
        bitWidth: 1
        access: read-write
      - name: OPERR
        description: Operation error
        bitOffset: 1
        bitWidth: 1
        access: read-write
      - name: WRPERR
        description: Write protection error
        bitOffset: 4
        bitWidth: 1
        access: read-write
      - name: PGAERR
        description: "Programming alignment\n              error"
        bitOffset: 5
        bitWidth: 1
        access: read-write
      - name: PGPERR
        description: "Programming parallelism\n              error"
        bitOffset: 6
        bitWidth: 1
        access: read-write
      - name: ERSERR
        description: Programming sequence error
        bitOffset: 7
        bitWidth: 1
        access: read-write
      - name: BSY
        description: Busy
        bitOffset: 16
        bitWidth: 1
        access: read-only
      - name: RDERR
        description: PCROP protection error
        bitOffset: 8
        bitWidth: 1
        access: read-write
  - name: CR
    displayName: CR
    description: Control register
    addressOffset: 16
    size: 32
    access: read-write
    resetValue: 2147483648
    fields:
      - name: PG
        description: Programming
        bitOffset: 0
        bitWidth: 1
      - name: SER
        description: Sector Erase
        bitOffset: 1
        bitWidth: 1
      - name: MER
        description: "Mass Erase of sectors 0 to\n              11"
        bitOffset: 2
        bitWidth: 1
      - name: SNB
        description: Sector number
        bitOffset: 3
        bitWidth: 5
      - name: PSIZE
        description: Program size
        bitOffset: 8
        bitWidth: 2
      - name: MER2
        description: "Mass Erase of sectors 12 to\n              23"
        bitOffset: 15
        bitWidth: 1
      - name: STRT
        description: Start
        bitOffset: 16
        bitWidth: 1
      - name: EOPIE
        description: "End of operation interrupt\n              enable"
        bitOffset: 24
        bitWidth: 1
      - name: ERRIE
        description: Error interrupt enable
        bitOffset: 25
        bitWidth: 1
      - name: LOCK
        description: Lock
        bitOffset: 31
        bitWidth: 1
      - name: RDERRIE
        description: PCROP error interrupt enable
        bitOffset: 26
        bitWidth: 1
  - name: OPTCR
    displayName: OPTCR
    description: Flash option control register
    addressOffset: 20
    size: 32
    access: read-write
    resetValue: 268413677
    fields:
      - name: OPTLOCK
        description: Option lock
        bitOffset: 0
        bitWidth: 1
      - name: OPTSTRT
        description: Option start
        bitOffset: 1
        bitWidth: 1
      - name: BOR_LEV
        description: BOR reset Level
        bitOffset: 2
        bitWidth: 2
      - name: WWDG_SW
        description: User option bytes
        bitOffset: 4
        bitWidth: 1
      - name: IWDG_SW
        description: User option bytes
        bitOffset: 5
        bitWidth: 1
      - name: nRST_STOP
        description: User option bytes
        bitOffset: 6
        bitWidth: 1
      - name: nRST_STDBY
        description: User option bytes
        bitOffset: 7
        bitWidth: 1
      - name: RDP
        description: Read protect
        bitOffset: 8
        bitWidth: 8
      - name: nWRP
        description: Not write protect
        bitOffset: 16
        bitWidth: 12
      - name: nDBOOT
        description: "Dual Boot mode (valid only when\n              nDBANK=0)"
        bitOffset: 28
        bitWidth: 1
      - name: nDBANK
        description: Not dual bank mode
        bitOffset: 29
        bitWidth: 1
      - name: IWDG_STDBY
        description: "Independent watchdog counter freeze in\n              standby mode"
        bitOffset: 30
        bitWidth: 1
      - name: IWDG_STOP
        description: "Independent watchdog counter freeze in\n              Stop mode"
        bitOffset: 31
        bitWidth: 1
  - name: OPTCR1
    displayName: OPTCR1
    description: "Flash option control register\n          1"
    addressOffset: 24
    size: 32
    access: read-write
    resetValue: 268369920
    fields:
      - name: BOOT_ADD0
        description: "Boot base address when Boot pin\n              =0"
        bitOffset: 0
        bitWidth: 16
      - name: BOOT_ADD1
        description: "Boot base address when Boot pin\n              =1"
        bitOffset: 16
        bitWidth: 16
  - name: OPTCR2
    displayName: OPTCR2
    description: Flash option control register 2
    addressOffset: 28
    size: 32
    access: read-write
    resetValue: 2147483903
    fields:
      - {name: PCROPi, description: PCROP protection per sector, bitOffset: 0, bitWidth: 8}
      - {name: PCROP_RDP, description: PCROP zone preserved when RDP level decreased, bitOffset: 31, bitWidth: 1}
addressBlocks:
  - offset: 0
    size: 1024
    usage: registers
interrupts:
  - name: INTR
    description: Flash global interrupt
