name: PKA
description: Private key accelerator
groupName: PKA
baseAddress: 1108090880
registers:
- name: PKA_CR
  displayName: PKA_CR
  description: PKA control register
  addressOffset: 0
  size: 32
  resetValue: 0
  resetMask: 4294967295
  fields:
  - name: EN
    description: "PKA enable.\nWhen an illegal operation is selected while EN=1 OPERRF\
      \ bit is set in PKA_SR. See PKA_CR.MODE bitfield for details.\nWhen EN=0 PKA\
      \ RAM can still be accessed by the application."
    bitOffset: 0
    bitWidth: 1
    access: read-write
    enumeratedValues:
    - name: B_0x0
      description: Disable PKA
      value: 0
    - name: B_0x1
      description: Enable PKA.PKA becomes functional when INITOK is set by hardware
        in PKA_SR.
      value: 1
  - name: START
    description: "start the operation\nWriting 1 to this bit starts the operation\
      \ which is selected by MODE[5:0], using the operands and data already written\
      \ to the PKA RAM. This bit is always read as 0.\nWhen an illegal operation is\
      \ selected while START bit is set no operation is started, and OPERRF bit is\
      \ set in PKA_SR.\nSTART is ignored if PKA is busy."
    bitOffset: 1
    bitWidth: 1
    access: read-write
  - name: MODE
    description: "PKA operation code\nWhen an operation not listed here is written\
      \ by the application with EN bit set, OPERRF bit is set in PKA_SR register,\
      \ and the write to MODE bitfield is ignored. When PKA is configured in limited\
      \ mode (LMF = 1 in PKA_SR), writing a MODE different from 0x26 with EN bit to\
      \ 1 triggers OPERRF bit to be set and write to MODE bit is ignored."
    bitOffset: 8
    bitWidth: 6
    access: read-write
    enumeratedValues:
    - name: B_0x0
      description: Montgomery parameter computation then modular exponentiation
      value: 0
    - name: B_0x1
      description: Montgomery parameter computation only
      value: 1
    - name: B_0x2
      description: Modular exponentiation only (Montgomery parameter must be loaded
        first)
      value: 2
    - name: B_0x3
      description: Modular exponentiation (protected, used when manipulating secrets)
      value: 3
    - name: B_0x20
      description: Montgomery parameter computation then ECC scalar multiplication
      value: 32
    - name: B_0x24
      description: ECDSA sign
      value: 36
    - name: B_0x26
      description: ECDSA verification
      value: 38
    - name: B_0x28
      description: Point on elliptic curve Fp check
      value: 40
    - name: B_0x7
      description: RSA CRT exponentiation
      value: 7
    - name: B_0x8
      description: Modular inversion
      value: 8
    - name: B_0x9
      description: Arithmetic addition
      value: 9
    - name: B_0xA
      description: Arithmetic subtraction
      value: 10
    - name: B_0xB
      description: Arithmetic multiplication
      value: 11
    - name: B_0xC
      description: Arithmetic comparison
      value: 12
    - name: B_0xD
      description: Modular reduction
      value: 13
    - name: B_0xE
      description: Modular addition
      value: 14
    - name: B_0xF
      description: Modular subtraction
      value: 15
    - name: B_0x10
      description: Montgomery multiplication
      value: 16
    - name: B_0x23
      description: ECC complete addition
      value: 35
    - name: B_0x27
      description: ECC double base ladder
      value: 39
    - name: B_0x2F
      description: ECC projective to affine
      value: 47
  - name: PROCENDIE
    description: End of operation interrupt enable
    bitOffset: 17
    bitWidth: 1
    access: read-write
    enumeratedValues:
    - name: B_0x0
      description: No interrupt is generated when PROCENDF flag is set in PKA_SR.
      value: 0
    - name: B_0x1
      description: An interrupt is generated when PROCENDF flag is set in PKA_SR.
      value: 1
  - name: RAMERRIE
    description: RAM error interrupt enable
    bitOffset: 19
    bitWidth: 1
    access: read-write
    enumeratedValues:
    - name: B_0x0
      description: No interrupt is generated when RAMERRF flag is set in PKA_SR.
      value: 0
    - name: B_0x1
      description: An interrupt is generated when RAMERRF flag is set in PKA_SR.
      value: 1
  - name: ADDRERRIE
    description: Address error interrupt enable
    bitOffset: 20
    bitWidth: 1
    access: read-write
    enumeratedValues:
    - name: B_0x0
      description: No interrupt is generated when ADDRERRF flag is set in PKA_SR.
      value: 0
    - name: B_0x1
      description: An interrupt is generated when ADDRERRF flag is set in PKA_SR.
      value: 1
  - name: OPERRIE
    description: Operation error interrupt enable
    bitOffset: 21
    bitWidth: 1
    access: read-write
    enumeratedValues:
    - name: B_0x0
      description: No interrupt is generated when OPERRF flag is set in PKA_SR.
      value: 0
    - name: B_0x1
      description: An interrupt is generated when OPERRF flag is set in PKA_SR.
      value: 1
- name: PKA_SR
  displayName: PKA_SR
  description: PKA status register
  addressOffset: 4
  size: 32
  resetValue: 0
  resetMask: 4294967295
  fields:
  - name: INITOK
    description: "PKA initialization OK\nThis bit is asserted when PKA initialization\
      \ is complete. When RNG is not able to output proper random numbers INITOK stays\
      \ at 0."
    bitOffset: 0
    bitWidth: 1
    access: read-only
    enumeratedValues:
    - name: B_0x0
      description: PKA is not initialized correctly. START bit cannot be set.
      value: 0
    - name: B_0x1
      description: PKA is initialized correctly and can be used normally.
      value: 1
  - name: LMF
    description: "Limited mode flag\nThis bit is updated when EN bit in PKA_CR is\
      \ set"
    bitOffset: 1
    bitWidth: 1
    access: read-only
    enumeratedValues:
    - name: B_0x0
      description: All values documented in MODE bitfield can be used.
      value: 0
    - name: B_0x1
      description: Only ECDSA verification (MODE = 0x26) is supported by the PKA.
      value: 1
  - name: BUSY
    description: "PKA operation is in progress\nThis bit is set to 1 whenever START\
      \ bit in the PKA_CR is set. It is automatically cleared when the computation\
      \ is complete, meaning that PKA RAM can be safely accessed and a new operation\
      \ can be started.\nIf PKA is started with a wrong opcode, it is busy for a couple\
      \ of cycles, then it aborts automatically the operation and go back to ready\
      \ (BUSY bit is set to 0)."
    bitOffset: 16
    bitWidth: 1
    access: read-only
    enumeratedValues:
    - name: B_0x0
      description: No operation is in progress (default)
      value: 0
    - name: B_0x1
      description: An operation is in progress
      value: 1
  - name: PROCENDF
    description: PKA End of Operation flag
    bitOffset: 17
    bitWidth: 1
    access: read-only
    enumeratedValues:
    - name: B_0x0
      description: Operation in progress
      value: 0
    - name: B_0x1
      description: PKA operation is completed. This flag is set when the BUSY bit
        is deasserted.
      value: 1
  - name: RAMERRF
    description: "PKA RAM error flag\nThis bit is cleared using RAMERRFC bit in PKA_CLRFR."
    bitOffset: 19
    bitWidth: 1
    access: read-only
    enumeratedValues:
    - name: B_0x0
      description: No PKA RAM access error
      value: 0
    - name: B_0x1
      description: An AHB access to the PKA RAM occurred while the PKA core was computing
        and using its internal RAM (AHB PKA_RAM access are not allowed while PKA operation
        is in progress).
      value: 1
  - name: ADDRERRF
    description: "Address error flag\nThis bit is cleared using ADDRERRFC bit in PKA_CLRFR."
    bitOffset: 20
    bitWidth: 1
    access: read-only
    enumeratedValues:
    - name: B_0x0
      description: No address error
      value: 0
    - name: B_0x1
      description: Address access is out of range (unmapped address)
      value: 1
  - name: OPERRF
    description: "Operation error flag\nThis bit is cleared using OPERRFC bit in PKA_CLRFR."
    bitOffset: 21
    bitWidth: 1
    access: read-only
    enumeratedValues:
    - name: B_0x0
      description: No event error
      value: 0
    - name: B_0x1
      description: An illegal or unknown operation has been selected in PKA_CR register
      value: 1
- name: PKA_CLRFR
  displayName: PKA_CLRFR
  description: PKA clear flag register
  addressOffset: 8
  size: 32
  resetValue: 0
  resetMask: 4294967295
  fields:
  - name: PROCENDFC
    description: Clear PKA End of Operation flag
    bitOffset: 17
    bitWidth: 1
    access: write-only
    enumeratedValues:
    - name: B_0x0
      description: No action
      value: 0
    - name: B_0x1
      description: Clear the PROCENDF flag in PKA_SR
      value: 1
  - name: RAMERRFC
    description: Clear PKA RAM error flag
    bitOffset: 19
    bitWidth: 1
    access: write-only
    enumeratedValues:
    - name: B_0x0
      description: No action
      value: 0
    - name: B_0x1
      description: Clear the RAMERRF flag in PKA_SR
      value: 1
  - name: ADDRERRFC
    description: Clear address error flag
    bitOffset: 20
    bitWidth: 1
    access: write-only
    enumeratedValues:
    - name: B_0x0
      description: No action
      value: 0
    - name: B_0x1
      description: Clear the ADDRERRF flag in PKA_SR
      value: 1
  - name: OPERRFC
    description: Clear operation error flag
    bitOffset: 21
    bitWidth: 1
    access: write-only
    enumeratedValues:
    - name: B_0x0
      description: No action
      value: 0
    - name: B_0x1
      description: Clear the OPERRF flag in PKA_SR
      value: 1
interrupts:
- name: PKA
  description: PKA global interrupt
  value: 118
addressBlocks:
- offset: 0
  size: 8192
  usage: registers
