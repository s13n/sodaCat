# Created from RP2350.svd (Rev 0.1)

name: TRNG
description: ARM TrustZone RNG register block
registers:
  - name: RNG_IMR
    addressOffset: 256
    description: Interrupt masking.
    resetValue: 15
    fields:
      - name: EHR_VALID_INT_MASK
        description: 1'b1-mask interrupt, no interrupt will be generated. See 
          RNG_ISR for an explanation on this interrupt.
        access: read-write
        bitOffset: 0
        bitWidth: 1
      - name: AUTOCORR_ERR_INT_MASK
        description: 1'b1-mask interrupt, no interrupt will be generated. See 
          RNG_ISR for an explanation on this interrupt.
        access: read-write
        bitOffset: 1
        bitWidth: 1
      - name: CRNGT_ERR_INT_MASK
        description: 1'b1-mask interrupt, no interrupt will be generated. See 
          RNG_ISR for an explanation on this interrupt.
        access: read-write
        bitOffset: 2
        bitWidth: 1
      - name: VN_ERR_INT_MASK
        description: 1'b1-mask interrupt, no interrupt will be generated. See 
          RNG_ISR for an explanation on this interrupt.
        access: read-write
        bitOffset: 3
        bitWidth: 1
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 4
        bitWidth: 28
  - name: RNG_ISR
    addressOffset: 260
    description: RNG status register. If corresponding RNG_IMR bit is unmasked, 
      an interrupt will be generated.
    resetValue: 0
    fields:
      - name: EHR_VALID
        description: 1'b1 indicates that 192 bits have been collected in the 
          RNG, and are ready to be read.
        access: read-only
        bitOffset: 0
        bitWidth: 1
      - name: AUTOCORR_ERR
        description: 1'b1 indicates Autocorrelation test failed four times in a 
          row. When set, RNG cease from functioning until next reset.
        access: read-only
        bitOffset: 1
        bitWidth: 1
      - name: CRNGT_ERR
        description: 1'b1 indicates CRNGT in the RNG test failed. Failure occurs
          when two consecutive blocks of 16 collected bits are equal.
        access: read-only
        bitOffset: 2
        bitWidth: 1
      - name: VN_ERR
        description: 1'b1 indicates Von Neuman error. Error in von Neuman occurs
          if 32 consecutive collected bits are identical, ZERO or ONE.
        access: read-only
        bitOffset: 3
        bitWidth: 1
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 4
        bitWidth: 28
  - name: RNG_ICR
    addressOffset: 264
    description: Interrupt/status bit clear Register.
    resetValue: 0
    fields:
      - name: EHR_VALID
        description: Write 1'b1 - clear corresponding bit in RNG_ISR.
        access: read-write
        bitOffset: 0
        bitWidth: 1
      - name: AUTOCORR_ERR
        description: Cannot be cleared by SW! Only RNG reset clears this bit.
        access: read-write
        bitOffset: 1
        bitWidth: 1
      - name: CRNGT_ERR
        description: Write 1'b1 - clear corresponding bit in RNG_ISR.
        access: read-write
        bitOffset: 2
        bitWidth: 1
      - name: VN_ERR
        description: Write 1'b1 - clear corresponding bit in RNG_ISR.
        access: read-write
        bitOffset: 3
        bitWidth: 1
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 4
        bitWidth: 28
  - name: TRNG_CONFIG
    addressOffset: 268
    description: Selecting the inverter-chain length.
    resetValue: 0
    fields:
      - name: RND_SRC_SEL
        description: Selects the number of inverters (out of four possible 
          selections) in the ring oscillator (the entropy source).
        access: read-write
        bitOffset: 0
        bitWidth: 2
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 2
        bitWidth: 30
  - name: TRNG_VALID
    addressOffset: 272
    description: 192 bit collection indication.
    resetValue: 0
    fields:
      - name: EHR_VALID
        description: 1'b1 indicates that collection of bits in the RNG is 
          completed, and data can be read from EHR_DATA register.
        access: read-only
        bitOffset: 0
        bitWidth: 1
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 1
        bitWidth: 31
  - name: EHR_DATA0
    addressOffset: 276
    description: RNG collected bits.
    resetValue: 0
    fields:
      - name: EHR_DATA0
        description: Bits [31:0] of Entropy Holding Register (EHR) - RNG output 
          register
        access: read-only
        bitOffset: 0
        bitWidth: 32
  - name: EHR_DATA1
    addressOffset: 280
    description: RNG collected bits.
    resetValue: 0
    fields:
      - name: EHR_DATA1
        description: Bits [63:32] of Entropy Holding Register (EHR) - RNG output
          register
        access: read-only
        bitOffset: 0
        bitWidth: 32
  - name: EHR_DATA2
    addressOffset: 284
    description: RNG collected bits.
    resetValue: 0
    fields:
      - name: EHR_DATA2
        description: Bits [95:64] of Entropy Holding Register (EHR) - RNG output
          register
        access: read-only
        bitOffset: 0
        bitWidth: 32
  - name: EHR_DATA3
    addressOffset: 288
    description: RNG collected bits.
    resetValue: 0
    fields:
      - name: EHR_DATA3
        description: Bits [127:96] of Entropy Holding Register (EHR) - RNG 
          output register
        access: read-only
        bitOffset: 0
        bitWidth: 32
  - name: EHR_DATA4
    addressOffset: 292
    description: RNG collected bits.
    resetValue: 0
    fields:
      - name: EHR_DATA4
        description: Bits [159:128] of Entropy Holding Register (EHR) - RNG 
          output register
        access: read-only
        bitOffset: 0
        bitWidth: 32
  - name: EHR_DATA5
    addressOffset: 296
    description: RNG collected bits.
    resetValue: 0
    fields:
      - name: EHR_DATA5
        description: Bits [191:160] of Entropy Holding Register (EHR) - RNG 
          output register
        access: read-only
        bitOffset: 0
        bitWidth: 32
  - name: RND_SOURCE_ENABLE
    addressOffset: 300
    description: Enable signal for the random source.
    resetValue: 0
    fields:
      - name: RND_SRC_EN
        description: "* 1'b1 - entropy source is enabled. *1'b0 - entropy source is
          disabled"
        access: read-write
        bitOffset: 0
        bitWidth: 1
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 1
        bitWidth: 31
  - name: SAMPLE_CNT1
    addressOffset: 304
    description: Counts clocks between sampling of random bit.
    resetValue: 65535
    fields:
      - name: SAMPLE_CNTR1
        description: Sets the number of rng_clk cycles between two consecutive 
          ring oscillator samples. Note! If the Von-Neuman is bypassed, the 
          minimum value for sample counter must not be less then decimal 
          seventeen
        access: read-write
        bitOffset: 0
        bitWidth: 32
  - name: AUTOCORR_STATISTIC
    addressOffset: 308
    description: Statistic about Autocorrelation test activations.
    resetValue: 0
    fields:
      - name: AUTOCORR_TRYS
        description: Count each time an autocorrelation test starts. Any write 
          to the register reset the counter. Stop collecting statistic if one of
          the counters reached the limit.
        access: read-write
        bitOffset: 0
        bitWidth: 14
      - name: AUTOCORR_FAILS
        description: Count each time an autocorrelation test fails. Any write to
          the register reset the counter. Stop collecting statistic if one of 
          the counters reached the limit.
        access: read-write
        bitOffset: 14
        bitWidth: 8
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 22
        bitWidth: 10
  - name: TRNG_DEBUG_CONTROL
    addressOffset: 312
    description: Debug register.
    resetValue: 0
    fields:
      - name: RESERVED
        description: N/A
        access: read-only
        bitOffset: 0
        bitWidth: 1
      - name: VNC_BYPASS
        description: When set, the Von-Neuman balancer is bypassed (including 
          the 32 consecutive bits test).
        access: read-write
        bitOffset: 1
        bitWidth: 1
      - name: TRNG_CRNGT_BYPASS
        description: When set, the CRNGT test in the RNG is bypassed.
        access: read-write
        bitOffset: 2
        bitWidth: 1
      - name: AUTO_CORRELATE_BYPASS
        description: When set, the autocorrelation test in the TRNG module is 
          bypassed.
        access: read-write
        bitOffset: 3
        bitWidth: 1
  - name: TRNG_SW_RESET
    addressOffset: 320
    description: Generate internal SW reset within the RNG block.
    resetValue: 0
    fields:
      - name: TRNG_SW_RESET
        description: Writing 1'b1 to this register causes an internal RNG reset.
        access: read-write
        bitOffset: 0
        bitWidth: 1
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 1
        bitWidth: 31
  - name: RNG_DEBUG_EN_INPUT
    addressOffset: 436
    description: Enable the RNG debug mode
    resetValue: 0
    fields:
      - name: RNG_DEBUG_EN
        description: "* 1'b1 - debug mode is enabled. *1'b0 - debug mode is disabled"
        access: read-write
        bitOffset: 0
        bitWidth: 1
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 1
        bitWidth: 31
  - name: TRNG_BUSY
    addressOffset: 440
    description: RNG Busy indication.
    resetValue: 0
    fields:
      - name: TRNG_BUSY
        description: Reflects rng_busy status.
        access: read-only
        bitOffset: 0
        bitWidth: 1
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 1
        bitWidth: 31
  - name: RST_BITS_COUNTER
    addressOffset: 444
    description: Reset the counter of collected bits in the RNG.
    resetValue: 0
    fields:
      - name: RST_BITS_COUNTER
        description: Writing any value to this address will reset the bits 
          counter and RNG valid registers. RND_SORCE_ENABLE register must be 
          unset in order for the reset to take place.
        access: read-write
        bitOffset: 0
        bitWidth: 1
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 1
        bitWidth: 31
  - name: RNG_VERSION
    addressOffset: 448
    description: Displays the version settings of the TRNG.
    resetValue: 0
    fields:
      - name: EHR_WIDTH_192
        description: "* 1'b1 - 192-bit EHR. *1'b0 - 128-bit EHR"
        access: read-only
        bitOffset: 0
        bitWidth: 1
      - name: CRNGT_EXISTS
        description: "* 1'b1 - Exists. *1'b0 - Does not exist"
        access: read-only
        bitOffset: 1
        bitWidth: 1
      - name: AUTOCORR_EXISTS
        description: "* 1'b1 - Exists. *1'b0 - Does not exist"
        access: read-only
        bitOffset: 2
        bitWidth: 1
      - name: TRNG_TESTS_BYPASS_EN
        description: "* 1'b1 - Exists. *1'b0 - Does not exist"
        access: read-only
        bitOffset: 3
        bitWidth: 1
      - name: PRNG_EXISTS
        description: "* 1'b1 - Exists. *1'b0 - Does not exist"
        access: read-only
        bitOffset: 4
        bitWidth: 1
      - name: KAT_EXISTS
        description: "* 1'b1 - Exists. *1'b0 - Does not exist"
        access: read-only
        bitOffset: 5
        bitWidth: 1
      - name: RESEEDING_EXISTS
        description: "* 1'b1 - Exists. *1'b0 - Does not exist"
        access: read-only
        bitOffset: 6
        bitWidth: 1
      - name: RNG_USE_5_SBOXES
        description: "* 1'b1 - 5 SBOX AES. *1'b0 - 20 SBOX AES"
        access: read-only
        bitOffset: 7
        bitWidth: 1
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 8
        bitWidth: 24
  - name: RNG_BIST_CNTR_0
    addressOffset: 480
    description: Collected BIST results.
    resetValue: 0
    fields:
      - name: ROSC_CNTR_VAL
        description: Reflects the results of RNG BIST counter.
        access: read-only
        bitOffset: 0
        bitWidth: 22
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 22
        bitWidth: 10
  - name: RNG_BIST_CNTR_1
    addressOffset: 484
    description: Collected BIST results.
    resetValue: 0
    fields:
      - name: ROSC_CNTR_VAL
        description: Reflects the results of RNG BIST counter.
        access: read-only
        bitOffset: 0
        bitWidth: 22
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 22
        bitWidth: 10
  - name: RNG_BIST_CNTR_2
    addressOffset: 488
    description: Collected BIST results.
    resetValue: 0
    fields:
      - name: ROSC_CNTR_VAL
        description: Reflects the results of RNG BIST counter.
        access: read-only
        bitOffset: 0
        bitWidth: 22
      - name: RESERVED
        description: RESERVED
        access: read-only
        bitOffset: 22
        bitWidth: 10
interrupts:
  - name: TRNG_IRQ
addressBlocks:
  - offset: 0
    size: 492
    usage: registers
